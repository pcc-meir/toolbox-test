{"version":3,"file":"EntityValidator.esm.js","sources":["../../../src/components/Validators/EntityValidator.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { DefaultEditor } from '../DefaultEditor';\nimport { validate } from '@roadiehq/roadie-backstage-entity-validator';\nimport Alert from '@mui/material/Alert';\nimport AlertTitle from '@mui/material/AlertTitle';\nimport { useToolboxTranslation } from '../../hooks';\n\nexport const EntityValidator = () => {\n  const { t } = useToolboxTranslation();\n  const [output, setOutput] = React.useState(\n    <Alert severity=\"info\">{t('tool.entity-validator.alertEmptyValue')}</Alert>,\n  );\n  const [input, setInput] = React.useState('');\n  const sample =\n    'apiVersion: backstage.io/v1alpha1\\n' +\n    'kind: Component\\n' +\n    'metadata:\\n' +\n    '  name: artist-web\\n' +\n    '  description: The place to be, for great artists\\n' +\n    '  labels:\\n' +\n    '    example.com/custom: custom_label_value\\n' +\n    '  annotations:\\n' +\n    '    example.com/service-discovery: artistweb\\n' +\n    '    circleci.com/project-slug: github/example-org/artist-website\\n' +\n    '  tags:\\n' +\n    '    - java\\n' +\n    '  links:\\n' +\n    '    - url: https://admin.example-org.com\\n' +\n    '      title: Admin Dashboard\\n' +\n    '      icon: dashboard\\n' +\n    '      type: admin-dashboard\\n' +\n    'spec:\\n' +\n    '  type: website\\n' +\n    '  lifecycle: production\\n' +\n    '  owner: artist-relations-team\\n' +\n    '  system: public-websites';\n\n  const formatError = (err: Error) => {\n    let msg = err.message;\n    msg = msg\n      .replace(\n        /TypeError: Cannot read properties of undefined \\(reading 'namespace'\\)/,\n        \"Must have required property: 'metadata' - missingProperty: 'metadata'\",\n      )\n      .replace(/TypeError: (.*)/, '$1')\n      .replace(/YAMLException: (.*)/, 'YAML error: $1')\n      .replaceAll('|', '<br>');\n    return msg;\n  };\n\n  useEffect(() => {\n    if (!input) {\n      setOutput(\n        <Alert severity=\"info\">\n          {t('tool.entity-validator.alertEmptyValue')}\n        </Alert>,\n      );\n      return;\n    }\n\n    validate(input, true)\n      .then(() => {\n        setOutput(\n          <Alert severity=\"success\">\n            <AlertTitle>\n              {t('tool.entity-validator.alertSuccessTitle')}\n            </AlertTitle>\n            {t('tool.entity-validator.alertValidEntity')}\n          </Alert>,\n        );\n      })\n      .catch(err => {\n        setOutput(\n          <Alert severity=\"error\">\n            <AlertTitle>\n              {t('tool.entity-validator.alertErrorTitle')}\n            </AlertTitle>\n            <div dangerouslySetInnerHTML={{ __html: formatError(err) }} />\n          </Alert>,\n        );\n      });\n  }, [input, t]);\n\n  return (\n    <DefaultEditor\n      input={input}\n      setInput={setInput}\n      sample={sample}\n      rightContent={<>{output}</>}\n      allowFileUpload\n      inputLabel={t('tool.entity-validator.inputLabel')}\n      acceptFileTypes=\".yaml,.yml\"\n      allowFileDownload\n      downloadFileName=\"catalog-info.yaml\"\n      downloadFileType=\"application/yaml\"\n    />\n  );\n};\n\nexport default EntityValidator;\n"],"names":[],"mappings":";;;;;;;AAOO,MAAM,kBAAkB,MAAM;AACnC,EAAM,MAAA,EAAE,CAAE,EAAA,GAAI,qBAAsB,EAAA,CAAA;AACpC,EAAA,MAAM,CAAC,MAAA,EAAQ,SAAS,CAAA,GAAI,KAAM,CAAA,QAAA;AAAA,wCAC/B,KAAM,EAAA,EAAA,QAAA,EAAS,MAAQ,EAAA,EAAA,CAAA,CAAE,uCAAuC,CAAE,CAAA;AAAA,GACrE,CAAA;AACA,EAAA,MAAM,CAAC,KAAO,EAAA,QAAQ,CAAI,GAAA,KAAA,CAAM,SAAS,EAAE,CAAA,CAAA;AAC3C,EAAA,MAAM,MACJ,GAAA,okBAAA,CAAA;AAuBF,EAAM,MAAA,WAAA,GAAc,CAAC,GAAe,KAAA;AAClC,IAAA,IAAI,MAAM,GAAI,CAAA,OAAA,CAAA;AACd,IAAA,GAAA,GAAM,GACH,CAAA,OAAA;AAAA,MACC,wEAAA;AAAA,MACA,uEAAA;AAAA,KACF,CACC,OAAQ,CAAA,iBAAA,EAAmB,IAAI,CAAA,CAC/B,OAAQ,CAAA,qBAAA,EAAuB,gBAAgB,CAAA,CAC/C,UAAW,CAAA,GAAA,EAAK,MAAM,CAAA,CAAA;AACzB,IAAO,OAAA,GAAA,CAAA;AAAA,GACT,CAAA;AAEA,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,IAAI,CAAC,KAAO,EAAA;AACV,MAAA,SAAA;AAAA,4CACG,KAAM,EAAA,EAAA,QAAA,EAAS,MACb,EAAA,EAAA,CAAA,CAAE,uCAAuC,CAC5C,CAAA;AAAA,OACF,CAAA;AACA,MAAA,OAAA;AAAA,KACF;AAEA,IAAA,QAAA,CAAS,KAAO,EAAA,IAAI,CACjB,CAAA,IAAA,CAAK,MAAM;AACV,MAAA,SAAA;AAAA,wBACG,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,EAAM,QAAS,EAAA,SAAA,EAAA,kBACb,KAAA,CAAA,aAAA,CAAA,UAAA,EAAA,IAAA,EACE,CAAE,CAAA,yCAAyC,CAC9C,CAAA,EACC,CAAE,CAAA,wCAAwC,CAC7C,CAAA;AAAA,OACF,CAAA;AAAA,KACD,CACA,CAAA,KAAA,CAAM,CAAO,GAAA,KAAA;AACZ,MAAA,SAAA;AAAA,4CACG,KAAM,EAAA,EAAA,QAAA,EAAS,2BACb,KAAA,CAAA,aAAA,CAAA,UAAA,EAAA,IAAA,EACE,EAAE,uCAAuC,CAC5C,mBACC,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,EAAI,yBAAyB,EAAE,MAAA,EAAQ,YAAY,GAAG,CAAA,IAAK,CAC9D,CAAA;AAAA,OACF,CAAA;AAAA,KACD,CAAA,CAAA;AAAA,GACF,EAAA,CAAC,KAAO,EAAA,CAAC,CAAC,CAAA,CAAA;AAEb,EACE,uBAAA,KAAA,CAAA,aAAA;AAAA,IAAC,aAAA;AAAA,IAAA;AAAA,MACC,KAAA;AAAA,MACA,QAAA;AAAA,MACA,MAAA;AAAA,MACA,YAAA,4DAAiB,MAAO,CAAA;AAAA,MACxB,eAAe,EAAA,IAAA;AAAA,MACf,UAAA,EAAY,EAAE,kCAAkC,CAAA;AAAA,MAChD,eAAgB,EAAA,YAAA;AAAA,MAChB,iBAAiB,EAAA,IAAA;AAAA,MACjB,gBAAiB,EAAA,mBAAA;AAAA,MACjB,gBAAiB,EAAA,kBAAA;AAAA,KAAA;AAAA,GACnB,CAAA;AAEJ;;;;"}