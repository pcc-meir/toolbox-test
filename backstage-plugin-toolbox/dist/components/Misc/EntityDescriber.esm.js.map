{"version":3,"file":"EntityDescriber.esm.js","sources":["../../../src/components/Misc/EntityDescriber.tsx"],"sourcesContent":["import { useApi } from '@backstage/core-plugin-api';\nimport { catalogApiRef } from '@backstage/plugin-catalog-react';\nimport React, { useEffect } from 'react';\nimport { Entity } from '@backstage/catalog-model';\nimport { CopyToClipboardButton } from '../Buttons';\nimport { useStyles } from '../../utils/hooks';\nimport YAML from 'yaml';\nimport { FileDownloadButton } from '../Buttons/FileDownloadButton';\nimport FormControl from '@mui/material/FormControl';\nimport Grid from '@mui/material/Grid';\nimport ButtonGroup from '@mui/material/ButtonGroup';\nimport TextField from '@mui/material/TextField';\nimport Autocomplete from '@mui/material/Autocomplete';\nimport { useToolboxTranslation } from '../../hooks';\n\nexport const EntityDescriber = () => {\n  const catalogApi = useApi(catalogApiRef);\n  const { classes } = useStyles();\n\n  const [entity, setEntity] = React.useState<Entity | null>(null);\n  const [output, setOutput] = React.useState('');\n  const [availableEntities, setAvailableEntities] = React.useState<\n    Entity[] | null\n  >([]);\n  const { t } = useToolboxTranslation();\n  useEffect(() => {\n    catalogApi.getEntities().then(data => {\n      if (data) {\n        setAvailableEntities(data.items);\n      }\n    });\n  }, [catalogApi]);\n\n  useEffect(() => {\n    if (entity) {\n      setOutput(YAML.stringify(entity));\n    } else {\n      setOutput('');\n    }\n  }, [entity]);\n\n  const getEntityTitle = (ent: Entity) => {\n    if (ent.metadata.title) {\n      return ent.metadata.title;\n    }\n    return ent.metadata.name\n      .split(/[_.-]+/)\n      .map(a => a.charAt(0).toUpperCase() + a.slice(1))\n      .join(' ');\n  };\n\n  return (\n    <FormControl className={classes.fullWidth}>\n      <Grid container spacing={4} style={{ marginBottom: '5px' }}>\n        <Grid item>\n          <ButtonGroup size=\"small\">\n            {output && <CopyToClipboardButton output={output} />}\n            {output && (\n              <FileDownloadButton\n                content={output}\n                fileName=\"catalog-info.yaml\"\n                fileType=\"catalog-info.yaml\"\n              />\n            )}\n          </ButtonGroup>\n        </Grid>\n      </Grid>\n      <Grid container className={classes.fullWidth}>\n        <Grid item xs={4} lg={3}>\n          <Autocomplete\n            className={classes.fullWidth}\n            options={availableEntities ?? []}\n            getOptionLabel={option => getEntityTitle(option)}\n            groupBy={option => option.kind}\n            value={entity}\n            onChange={(_e, value) => setEntity(value)}\n            renderInput={params => (\n              <TextField\n                {...params}\n                label={t('tool.entity-describer.entityLabel')}\n                variant=\"outlined\"\n              />\n            )}\n          />\n        </Grid>\n        <Grid item xs={8} lg={9}>\n          <TextField\n            id=\"output\"\n            label={t('tool.entity-describer.outputLabel')}\n            value={output || ''}\n            className={classes.fullWidth}\n            multiline\n            minRows={20}\n            maxRows={50}\n            variant=\"outlined\"\n          />\n        </Grid>\n      </Grid>\n    </FormControl>\n  );\n};\nexport default EntityDescriber;\n"],"names":[],"mappings":"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"}